# 新功能使用指南

## 概述

本项目新增了两个重要功能：
1. **AI智能排版优化** - 自动优化幻灯片布局和元素排列
2. **多语言幻灯片生成** - 支持多种语言的PPT内容生成和翻译

## 功能体现方式

### 1. 菜单栏集成

在主界面的菜单栏中，新增了两个菜单：

#### 智能排版菜单
- **优化布局** - 自动优化当前幻灯片的元素布局
- **响应式调整** - 根据画布尺寸自动调整元素位置和大小
- **自动文本调整** - 自动调整选中文本元素的大小以适应容器

#### 多语言菜单
- **一键翻译当前幻灯片** - 一键翻译当前幻灯片的所有文本内容
- **批量翻译所有幻灯片** - 批量翻译所有幻灯片的所有文本内容
- **生成多语言PPT** - 根据主题生成多语言版本的PPT
- **切换语言** - 切换应用程序界面语言

### 2. 功能演示程序

运行 `NewFeaturesDemo` 类可以查看完整的功能演示：

```bash
# 编译项目
./gradlew build

# 运行演示程序
java -cp build/classes/java/main slideshow.NewFeaturesDemo
```

### 3. 核心功能类

#### IntelligentLayoutEngine (智能排版引擎)
- 支持多种布局类型：居中、左对齐、网格、流式、紧凑
- 动态布局调整和响应式设计
- 智能空间分配和内容自适应

#### MultilingualSupport (多语言支持)
- 支持8种语言：中文、英文、日文、韩文、法文、德文、西班牙文、俄文
- 国际化框架和语言切换功能
- 多语言内容生成和PPT命令生成

#### AIEnhancedAgent (增强AI代理)
- 集成智能排版和多语言功能
- 提供多语言内容生成接口
- 智能布局优化和响应式调整

## 使用方法

### 智能排版功能

1. **优化布局**
   - 选择要优化的幻灯片
   - 点击菜单 "智能排版" → "优化布局"
   - 系统会自动重新排列元素位置

2. **响应式调整**
   - 调整画布大小
   - 点击菜单 "智能排版" → "响应式调整"
   - 元素会根据新尺寸自动调整

3. **自动文本调整**
   - 选择一个文本元素
   - 点击菜单 "智能排版" → "自动文本调整"
   - 文本大小会自动调整以适应容器

### 多语言功能

1. **一键翻译当前幻灯片**
   - 选择要翻译的幻灯片
   - 点击菜单 "多语言" → "一键翻译当前幻灯片"
   - 选择目标语言
   - 系统会自动翻译幻灯片中的所有文本内容并更新显示

2. **批量翻译所有幻灯片**
   - 点击菜单 "多语言" → "批量翻译所有幻灯片"
   - 选择目标语言
   - 系统会自动翻译所有幻灯片中的所有文本内容
   - 显示翻译统计信息（翻译的幻灯片数量和文本元素数量）

3. **生成多语言PPT**
   - 点击菜单 "多语言" → "生成多语言PPT"
   - 输入PPT主题
   - 系统会生成多语言版本的PPT内容

4. **切换语言**
   - 点击菜单 "多语言" → "切换语言"
   - 选择目标语言
   - 界面语言会立即切换

## 技术特性

### 智能排版引擎特性
- **多种布局算法**：支持5种不同的布局类型
- **动态调整**：根据内容数量和类型自动选择最佳布局
- **响应式设计**：支持不同尺寸的自适应调整
- **智能空间分配**：自动计算和分配元素空间

### 多语言支持特性
- **8种语言支持**：覆盖主要国际语言
- **本地化资源**：提供完整的界面翻译
- **内容翻译**：支持幻灯片内容的实时翻译
- **PPT命令生成**：生成多语言版本的PPT制作命令

### 增强AI功能
- **智能内容生成**：结合AI的多语言内容生成
- **布局优化**：AI辅助的智能布局优化
- **演讲稿生成**：多语言演讲稿自动生成

## 配置文件

### 多语言资源文件
- `src/main/resources/i18n/messages_zh_CN.properties` - 中文资源
- `src/main/resources/i18n/messages_en_US.properties` - 英文资源

### 布局配置
- 布局类型在 `IntelligentLayoutEngine.LayoutType` 枚举中定义
- 支持语言在 `MultilingualSupport.SupportedLanguage` 枚举中定义

## 扩展性

### 添加新语言
1. 在 `MultilingualSupport.SupportedLanguage` 中添加新语言枚举
2. 创建对应的资源文件 `messages_xx_XX.properties`
3. 在翻译词典中添加新语言的词汇

### 添加新布局类型
1. 在 `IntelligentLayoutEngine.LayoutType` 中添加新布局类型
2. 在 `IntelligentLayoutEngine` 中实现对应的布局算法
3. 更新相关的测试用例

## 测试

运行测试类 `EnhancedFeaturesTest` 可以验证所有新功能：

```bash
./gradlew test --tests slideshow.EnhancedFeaturesTest
```

## 注意事项

1. **AI模型依赖**：部分功能需要配置有效的AI模型API密钥
2. **性能考虑**：大量元素时布局优化可能需要较长时间
3. **翻译质量**：翻译功能基于内置词典，复杂内容可能需要人工校对
4. **兼容性**：新功能与现有功能完全兼容，不会影响原有功能

## 故障排除

### 常见问题

1. **布局优化失败**
   - 检查幻灯片是否包含元素
   - 确认画布尺寸是否有效

2. **翻译功能异常**
   - 检查目标语言是否支持
   - 确认内容不为空

3. **AI功能不可用**
   - 检查API密钥配置
   - 确认网络连接正常

### 调试模式

启用详细日志输出：
```java
// 在Main类中设置日志级别
Logger.getLogger("slideshow").setLevel(Level.FINE);
```

## 更新日志

### v1.1.0 (新增功能)
- ✅ 智能排版优化引擎
- ✅ 多语言支持系统
- ✅ 增强AI代理功能
- ✅ 响应式布局调整
- ✅ 自动文本大小调整
- ✅ 多语言PPT生成
- ✅ 语言切换功能
- ✅ 翻译功能
- ✅ 演讲稿生成

这些新功能大大增强了PPT制作工具的智能化和国际化能力，为用户提供了更加便捷和强大的PPT制作体验。 